var P=Object.defineProperty;var N=(o,e,t)=>e in o?P(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var a=(o,e,t)=>(N(o,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();let R=1;function D(){return R++}class B{constructor(){a(this,"components");this.components=new Map}reset(){this.components=new Map}addEntity(e){const t=D();return this.components.set(t,e),t}getEntities(e){let t=[];for(let s of this.components.entries()){const[n,i]=s;e.every(u=>u in i)&&t.push(n)}return t.map(s=>({component:n=>{var i;return(i=this.components.get(s))==null?void 0:i[n]},addComponent:(n,i)=>{this.components.get(s)[n]=i},removeComponent:n=>{this.removeComponent(s,n)},delete:()=>{this.components.delete(s)}}))}addComponent(e,t,s){this.components.has(e)&&(this.components.get(e)[t]=s)}removeComponent(e,t){this.components.has(e)&&delete this.components.get(e)[t]}}class O{constructor(){a(this,"pool",{})}get(e){return this.pool[e]}set(e,t){this.pool[e]=t}reset(){this.pool={}}}class T{constructor(){a(this,"currentState");a(this,"systems");a(this,"systemOptions");this.currentState=void 0,this.systems=new Map,this.systemOptions=new Map}addState(e,t,s={}){this.systems.set(e,t),this.systemOptions.set(e,s)}transitionState(e,t){var n;this.currentState=e;const s=this.systemOptions.get(e);(n=s==null?void 0:s.initialize)==null||n.call(s,t)}getCurrentSystems(){return this.currentState?this.systems.get(this.currentState)||[]:[]}}class G{constructor({defaultGain:e=1}={}){a(this,"_audioContext");a(this,"_gainNode");a(this,"_soundEffects",{});var t,s,n;this._audioContext=new(window.webkitAudioContext||AudioContext),this._audioContext&&(this._gainNode=(t=this._audioContext)==null?void 0:t.createGain(),this._gainNode&&(this._gainNode.gain.value=e,(s=this._gainNode)==null||s.connect(this._audioContext.destination)),(n=this._audioContext)==null||n.addEventListener("statechange",()=>{var i;return console.log((i=this._audioContext)==null?void 0:i.state)}))}resume(){var e;(e=this._audioContext)==null||e.resume()}_loadBuffer(e){return new Promise(t=>{var s;(s=this._audioContext)==null||s.decodeAudioData(e,n=>{t(n)})})}async loadSoundEffect(e,t){this._soundEffects[e]=await this._loadBuffer(t)}start(e,t){if(this._audioContext&&this._gainNode&&this._soundEffects[e]){const s=this._audioContext.createBufferSource();s.buffer=this._soundEffects[e],s.connect(this._gainNode),s.start(0),s.addEventListener("ended",function n(){t==null||t(),s.removeEventListener("ended",n)})}}}const p=16;class q{constructor(){a(this,"entities");a(this,"resources");a(this,"stateMachine");a(this,"sound");this.entities=new B,this.resources=new O,this.stateMachine=new T,this.sound=new G}start(){this.tick()}tick(){let e=Date.now(),t=0;const s=()=>{const n=Date.now(),i=n-e;for(e=n,t+=i;t>=p;)this.update(),t-=p;requestAnimationFrame(s)};requestAnimationFrame(s)}getBaseContext(){const e=p/1e3;return{resources:this.resources,entities:this.entities,sound:this.sound,elapsedSeconds:e}}update(){const t={...this.getBaseContext(),changeState:n=>this.changeState(n)};this.stateMachine.getCurrentSystems().forEach(n=>{n(t)})}changeState(e){this.stateMachine.transitionState(e,this.getBaseContext())}}const r=Symbol(),d=Symbol(),M=Symbol(),_=Symbol(),A=Symbol(),y=Symbol(),f=Symbol(),c=Symbol(),m=Symbol(),S=Symbol(),w=Symbol(),l=Symbol(),g=Symbol(),b=Symbol(),v=Symbol(),E=Symbol(),I=Symbol(),L=Symbol();function U(o){const e=o.entities.getEntities([r,d]),t=o.resources.get(w);e.forEach(s=>{const n=s.component(r),i=s.component(d);"source"in i?t.drawImage(i.source,i.sourceX,i.sourceY,i.sourceWidth,i.sourceHeight,n[0],n[1],i.width,i.height):t.drawImage(i,n[0],n[1])})}function k(o,e){return{source:e,sourceX:o.frame.x,sourceY:o.frame.y,sourceWidth:o.frame.w,sourceHeight:o.frame.h,width:o.frame.w,height:o.frame.h}}function W(o){o.entities.getEntities([M]).forEach(e=>{let t=e.component(M);if(t.currentFrame<0)t.t=0,t.currentFrame=0,e.addComponent(d,k(t.frames[0],t.source));else{const s=t.frames[t.currentFrame];let n=t.t+p;n>=s.duration&&(n=n-s.duration,t.currentFrame===t.frames.length-1&&!t.loop?e.delete():(t.currentFrame=(t.currentFrame+1)%t.frames.length,e.addComponent(d,k(t.frames[t.currentFrame],t.source)))),t.t=n}})}const X=.05;function Y(o){const e=o.resources.get(b)||0;let t=o.resources.get(l)||0;const s=Math.sin(e)*Math.sin(e);t+=X,o.resources.set(g,s),o.resources.set(l,t)}function H(o){o.resources.set(b,(o.resources.get(b)||0)+o.elapsedSeconds)}function h(o){const e=new Image;return e.src=o,e}const V=""+new URL("background.35c07817.png",import.meta.url).href,Z=""+new URL("arm.556f89ce.png",import.meta.url).href,$=""+new URL("bag.e93ab520.png",import.meta.url).href,z=""+new URL("cornhole.61a1d885.png",import.meta.url).href,K=""+new URL("man.29fe1ffc.png",import.meta.url).href,j=""+new URL("title.6398feee.png",import.meta.url).href,J=h(V),Q=h(Z),x=h($),ee=h(z),te=h(K),se=h(j),ne=25,oe=20;function ie(o){if(o.resources.get(v)){const t=o.entities.getEntities([_])[0],s=o.resources.get(g)||0,n=o.resources.get(l)||0;if(o.resources.set(v,null),t){const i=t.component(r),u=i[0]+ne+Math.cos(n)*200,C=i[1]+oe-Math.sin(n)*200;o.entities.addEntity({[r]:[u,C],[d]:x,[A]:void 0,[y]:void 0,[f]:[Math.cos(n)*20*s,-Math.sin(n)*20*s]})}}}function re(o){const e=o.resources.get(l)||0,t=o.resources.get(g)||0,s=o.resources.get(w),n=o.entities.getEntities([_])[0];if(s&&n){s.save();const i=n.component(r);s.translate(i[0]+30,i[1]+20),s.rotate(-(e+Math.PI/2)),s.translate(-i[0]-30,-i[1]-20),s.drawImage(Q,i[0],i[1]),s.restore(),s.save(),s.fillStyle="white",s.fillRect(100,20,840,40),s.fillStyle="red",s.fillRect(100,20,840*t,40),s.fillStyle="black",s.font="24px sans-serif",s.textBaseline="top",s.fillText("POWER",460,30),s.restore(),s.save(),s.font="78px sans-serif",s.fillStyle="black";const u=o.resources.get(E)||0;s.textBaseline="top";const C=s.measureText(`${u}`);s.fillText(`${u}`,1024/2-C.width/2,650),s.restore()}}const ae=.15;function ce(o){o.entities.getEntities([r,f]).forEach(e=>{const t=e.component(r);let s=e.component(f);s[1]=s[1]+ae,e.addComponent(r,[t[0]+s[0],t[1]+s[1]])})}function me(o){const e=o.entities.getEntities([c,r,m]).map(t=>({points:t.component(c),pos:t.component(r),size:t.component(m)}));o.entities.getEntities([A,y]).forEach(t=>{const s=t.component(r),n=[s[0]+79/2,s[1]+63];e.forEach(i=>{n[0]>=i.pos[0]&&n[0]<=i.pos[0]+i.size[0]&&n[1]>=i.pos[1]&&n[1]<=i.pos[1]+i.size[1]&&(t.removeComponent(y),t.removeComponent(f),o.resources.set(E,(o.resources.get(E)||0)+i.points),i.points==3&&t.delete())}),n[1]>675&&(t.removeComponent(y),t.removeComponent(f),t.addComponent(S,10),(n[0]<0||n[0]>1024)&&t.delete())})}function ue(o){o.entities.getEntities([S]).forEach(e=>{let t=e.component(S);t-=o.elapsedSeconds,t<=0?e.delete():e.addComponent(S,t)})}class de{constructor(e){a(this,"canvas");a(this,"context");a(this,"engine");a(this,"keyDown");this.canvas=e,this.context=e.getContext("2d"),this.engine=new q,this.keyDown=!1,this.setup(),window.addEventListener("keydown",t=>{this.keyDown=!0,t.key===" "&&this.engine.resources.set(v,{angle:this.engine.resources.get(l)||0,power:this.engine.resources.get(g)||0})}),window.addEventListener("keyup",()=>{this.keyDown=!1})}setup(){this.engine.stateMachine.addState(I,[U,e=>{this.keyDown&&e.changeState(L)}],{initialize:e=>{e.entities.reset(),e.resources.reset(),e.resources.set(w,this.context),e.entities.addEntity({[r]:[0,0],[d]:se})}}),this.engine.stateMachine.addState(L,[H,W,U,Y,re,ie,ce,me,ue],{initialize:e=>{e.resources.reset(),e.entities.reset(),e.resources.set(w,this.context),e.resources.set(E,0),e.resources.set(l,0),e.resources.set(g,0),e.entities.addEntity({[r]:[0,0],[d]:J}),e.entities.addEntity({[r]:[20,75],[d]:te}),e.entities.addEntity({[r]:[50,260],[_]:void 0}),e.entities.addEntity({[r]:[750,550],[d]:ee}),e.entities.addEntity({[c]:1,[r]:[765,620],[m]:[20,20]}),e.entities.addEntity({[c]:1,[r]:[785,615],[m]:[20,25]}),e.entities.addEntity({[c]:1,[r]:[805,610],[m]:[40,30]}),e.entities.addEntity({[c]:1,[r]:[845,605],[m]:[20,35]}),e.entities.addEntity({[c]:1,[r]:[865,600],[m]:[20,40]}),e.entities.addEntity({[c]:3,[r]:[885,595],[m]:[20,45]}),e.entities.addEntity({[c]:3,[r]:[905,590],[m]:[20,50]}),e.entities.addEntity({[c]:3,[r]:[925,585],[m]:[20,55]}),e.entities.addEntity({[c]:1,[r]:[945,580],[m]:[20,60]})}}),this.engine.changeState(I)}start(){this.engine.start()}}const le=document.querySelector("#game"),F=new de(le);F.setup();F.start();
